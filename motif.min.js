!function(r,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n(require,exports,module):r.motif=n()}(this,function(r,n,t){function e(r,n){return u.parse(r,{lookup:n})}var u=function(){function r(r,n){function t(){this.constructor=r}t.prototype=n.prototype,r.prototype=new t}function n(r,n,t,e,u,i){this.message=r,this.expected=n,this.found=t,this.offset=e,this.line=u,this.column=i,this.name="SyntaxError"}function t(r){function t(){return r.substring(Pr,Or)}function e(n){function t(n,t,e){var u,i;for(u=t;u<e;u++)i=r.charAt(u),"\n"===i?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1)}return Qr!==n&&(Qr>n&&(Qr=0,Tr={line:1,column:1,seenCR:!1}),t(Tr,Qr,n),Qr=n),Tr}function u(r){Or<Vr||(Or>Vr&&(Vr=Or,Wr=[]),Wr.push(r))}function i(t,u,i){function o(r){var n=1;for(r.sort(function(r,n){return r.description<n.description?-1:r.description>n.description?1:0});n<r.length;)r[n-1]===r[n]?r.splice(n,1):n++}function c(r,n){function t(r){function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(r){return"\\x0"+n(r)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(r){return"\\x"+n(r)}).replace(/[\u0180-\u0FFF]/g,function(r){return"\\u0"+n(r)}).replace(/[\u1080-\uFFFF]/g,function(r){return"\\u"+n(r)})}var e,u,i,o=Array(r.length);for(i=0;i<r.length;i++)o[i]=r[i].description;return e=r.length>1?o.slice(0,-1).join(", ")+" or "+o[r.length-1]:o[0],u=n?'"'+t(n)+'"':"end of input","Expected "+e+" but "+u+" found."}var f=e(i),a=i<r.length?r.charAt(i):null;return null!==u&&o(u),new n(null!==t?t:c(u,a),u,a,i,f.line,f.column)}function o(){var r;return r=c()}function c(){var r;return r=f(),r===X&&(r=a()),r}function f(){var n,t,e,i,o,c;if(n=Or,t=a(),t!==X){if(e=[],i=Or,44===r.charCodeAt(Or)?(o=rr,Or++):(o=X,0===Xr&&u(nr)),o!==X?(c=a(),c!==X?(Pr=i,o=tr(c),i=o):(Or=i,i=_)):(Or=i,i=_),i!==X)for(;i!==X;)e.push(i),i=Or,44===r.charCodeAt(Or)?(o=rr,Or++):(o=X,0===Xr&&u(nr)),o!==X?(c=a(),c!==X?(Pr=i,o=tr(c),i=o):(Or=i,i=_)):(Or=i,i=_);else e=_;e!==X?(Pr=n,t=er(t,e),n=t):(Or=n,n=_)}else Or=n,n=_;return n}function a(){var r,n,t;if(r=Or,n=[],t=s(),t!==X)for(;t!==X;)n.push(t),t=s();else n=_;return n!==X&&(Pr=r,n=ur(n)),r=n}function s(){var r;return r=l(),r===X&&(r=d()),r}function l(){var r,n,t,e,u,i,o;for(r=Or,n=[],t=g();t!==X;)n.push(t),t=g();if(n!==X)if(t=p(),t!==X){if(e=[],u=Or,i=[],o=g(),o!==X)for(;o!==X;)i.push(o),o=g();else i=_;for(i!==X?(o=p(),o!==X?(Pr=u,i=ir(o),u=i):(Or=u,u=_)):(Or=u,u=_);u!==X;){if(e.push(u),u=Or,i=[],o=g(),o!==X)for(;o!==X;)i.push(o),o=g();else i=_;i!==X?(o=p(),o!==X?(Pr=u,i=ir(o),u=i):(Or=u,u=_)):(Or=u,u=_)}if(e!==X){for(u=[],i=g();i!==X;)u.push(i),i=g();u!==X?(Pr=r,n=or(t,e),r=n):(Or=r,r=_)}else Or=r,r=_}else Or=r,r=_;else Or=r,r=_;return r}function p(){var r;return r=h(),r===X&&(r=y()),r}function h(){var n,t,e,i;return n=Or,t=v(),t!==X?(42===r.charCodeAt(Or)?(e=cr,Or++):(e=X,0===Xr&&u(fr)),e!==X?(i=C(),i!==X?(Pr=n,t=ar(t,i),n=t):(Or=n,n=_)):(Or=n,n=_)):(Or=n,n=_),n}function v(){var r;return r=y(),r===X&&(r=d()),r}function d(){var n,t,e,i,o,f,a;for(n=Or,t=[],e=g();e!==X;)t.push(e),e=g();if(t!==X)if(91===r.charCodeAt(Or)?(e=sr,Or++):(e=X,0===Xr&&u(lr)),e!==X)if(i=c(),i===X&&(i=pr),i!==X)if(93===r.charCodeAt(Or)?(o=hr,Or++):(o=X,0===Xr&&u(vr)),o!==X){for(f=[],a=g();a!==X;)f.push(a),a=g();f!==X?(Pr=n,t=dr(i),n=t):(Or=n,n=_)}else Or=n,n=_;else Or=n,n=_;else Or=n,n=_;else Or=n,n=_;return n}function g(){var n,t;return Xr++,yr.test(r.charAt(Or))?(n=r.charAt(Or),Or++):(n=X,0===Xr&&u(Ar)),Xr--,n===X&&(t=X,0===Xr&&u(gr)),n}function y(){var r,n;return r=Or,n=A(),n!==X&&(Pr=r,n=xr(n)),r=n,r===X&&(r=Or,n=x(),n!==X&&(Pr=r,n=Cr()),r=n),r}function A(){var r,n;return r=Or,n=C(),n===X&&(n=F()),n!==X&&(Pr=r,n=mr(n)),r=n}function x(){var n,t;return n=Or,126===r.charCodeAt(Or)?(t=Fr,Or++):(t=X,0===Xr&&u(Er)),t!==X&&(Pr=n,t=Rr()),n=t}function C(){var r,n,t,e,i;return Xr++,r=Or,n=b(),n===X&&(n=pr),n!==X?(t=m(),t!==X?(e=w(),e===X&&(e=pr),e!==X?(i=Z(),i===X&&(i=pr),i!==X?(Pr=r,n=zr(),r=n):(Or=r,r=_)):(Or=r,r=_)):(Or=r,r=_)):(Or=r,r=_),Xr--,r===X&&(n=X,0===Xr&&u(br)),r}function m(){var r,n,t;if(Xr++,r=Or,n=[],t=E(),t!==X)for(;t!==X;)n.push(t),t=E();else n=_;return n!==X&&(Pr=r,n=wr()),r=n,Xr--,r===X&&(n=X,0===Xr&&u(Zr)),r}function F(){var n,t,e,i,o,c;if(Xr++,n=Or,t=Or,e=[],i=q(),i!==X)for(;i!==X;)e.push(i),i=q();else e=_;if(e!==X){for(i=[],o=k();o!==X;)i.push(o),o=k();if(i!==X){for(o=[],c=q();c!==X;)o.push(c),c=q();o!==X?(e=[e,i,o],t=e):(Or=t,t=_)}else Or=t,t=_}else Or=t,t=_;return t!==X&&(t=r.substring(n,Or)),n=t,Xr--,n===X&&(t=X,0===Xr&&u(Sr)),n}function E(){var n;return jr.test(r.charAt(Or))?(n=r.charAt(Or),Or++):(n=X,0===Xr&&u(kr)),n}function R(){var n;return 46===r.charCodeAt(Or)?(n=qr,Or++):(n=X,0===Xr&&u(Br)),n}function b(){var r;return r=S(),r===X&&(r=j()),r}function z(){var n;return Ir.test(r.charAt(Or))?(n=r.charAt(Or),Or++):(n=X,0===Xr&&u(Ur)),n}function Z(){var r,n,t,e,u;if(r=Or,n=z(),n!==X)if(t=S(),t===X&&(t=j()),t===X&&(t=pr),t!==X){if(e=[],u=E(),u!==X)for(;u!==X;)e.push(u),u=E();else e=_;e!==X?(n=[n,t,e],r=n):(Or=r,r=_)}else Or=r,r=_;else Or=r,r=_;return r}function w(){var r,n,t,e;if(r=Or,n=R(),n!==X){if(t=[],e=E(),e!==X)for(;e!==X;)t.push(e),e=E();else t=_;t!==X?(n=[n,t],r=n):(Or=r,r=_)}else Or=r,r=_;return r}function S(){var n;return 45===r.charCodeAt(Or)?(n=Dr,Or++):(n=X,0===Xr&&u(Gr)),n}function j(){var n;return 43===r.charCodeAt(Or)?(n=Hr,Or++):(n=X,0===Xr&&u(Jr)),n}function k(){var n;return Kr.test(r.charAt(Or))?(n=r.charAt(Or),Or++):(n=X,0===Xr&&u(Lr)),n}function q(){var n;return Mr.test(r.charAt(Or))?(n=r.charAt(Or),Or++):(n=X,0===Xr&&u(Nr)),n}function B(r){var n=W.lookup;return n&&r in n?n[r]:r}function I(r,n){return[r].concat(n)}function U(r,n){for(var t=-1,e=[];++t<n;)e.push(D(r));return e}function D(r){return Yr(r)?G([],r):r}function G(r,n){for(var t=n.length,e=-1;++e<t;)r.push(n[e]);return r}function H(r,n){return Yr(n)?G(r,n):r.push(n),r}function J(r){return r.reduce(H,[])}function K(r,n){for(var t=[],e=r.length,u=n/e-1,i=-1;++i<e;)t.push(r[i]),G(t,U([],u));return t}function L(r,n){for(var t=[],e=Array.prototype.slice.call(arguments,2),u=r.length,i=-1;++i<u;)t.push(n.apply(null,G([r[i]],e)));return t}function M(r,n){var t;n>r&&(t=r,r=n,n=t);for(var e=r;e%n;)e+=r;return e}function N(r){return r.length}function O(r){var n=L(r,N).reduce(M);return L(r,K,n)}function P(r){return O(r).reduce(G)}function Q(r,n,t){var e=r[n];return void 0===e&&(e=r[n]=[]),H(e,t),r}function T(r){r=O(r);for(var n,t,e,u=[],i=r.length,o=-1;++o<i;)for(n=r[o],t=n.length,e=-1;++e<t;)Q(u,e,n[e]);return u}var V,W=arguments.length>1?arguments[1]:{},X={},Y={start:o},$=o,_=X,rr=",",nr={type:"literal",value:",",description:'","'},tr=function(r){return r},er=function(r,n){return T(I(r,n))},ur=function(r){return P(r)},ir=function(r){return r},or=function(r,n){return I(r,n).reduce(G)},cr="*",fr={type:"literal",value:"*",description:'"*"'},ar=function(r,n){return J(U(r,n))},sr="[",lr={type:"literal",value:"[",description:'"["'},pr=null,hr="]",vr={type:"literal",value:"]",description:'"]"'},dr=function(r){return r||[]},gr={type:"other",description:"whitespace"},yr=/^[ \t\n\r]/,Ar={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},xr=function(r){return[[r]]},Cr=function(){return[[]]},mr=function(r){return B(r)},Fr="~",Er={type:"literal",value:"~",description:'"~"'},Rr=function(){return[]},br={type:"other",description:"number"},zr=function(){return parseFloat(t())},Zr={type:"other",description:"integer"},wr=function(){return parseInt(t())},Sr={type:"other",description:"string"},jr=/^[0-9]/,kr={type:"class",value:"[0-9]",description:"[0-9]"},qr=".",Br={type:"literal",value:".",description:'"."'},Ir=/^[eE]/,Ur={type:"class",value:"[eE]",description:"[eE]"},Dr="-",Gr={type:"literal",value:"-",description:'"-"'},Hr="+",Jr={type:"literal",value:"+",description:'"+"'},Kr=/^[a-zA-Z]/,Lr={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},Mr=/^[a-zA-Z0-9]/,Nr={type:"class",value:"[a-zA-Z0-9]",description:"[a-zA-Z0-9]"},Or=0,Pr=0,Qr=0,Tr={line:1,column:1,seenCR:!1},Vr=0,Wr=[],Xr=0;if("startRule"in W){if(!(W.startRule in Y))throw Error("Can't start parsing from rule \""+W.startRule+'".');$=Y[W.startRule]}var Yr=Array.isArray;if(V=$(),V!==X&&Or===r.length)return V;throw V!==X&&Or<r.length&&u({type:"end",description:"end of input"}),i(null,Wr,Vr)}return r(n,Error),{SyntaxError:n,parse:t}}();return e.SyntaxError=u.SyntaxError,e});